!function(a,b){function c(b,c){this.element=b,this.options=a.extend({},e,c),this._defaults=e,this._name=d,this.init()}var d="imgSmartLoad",e={load_all_images_on_first_scroll:!1,attribute:"data-src",threshold:200};c.prototype.init=function(){var c=this,d=a("img["+this.options.attribute+"]",this.element);this.increment=1,this.timer=0,d.bind("scrollin",{},function(){c._load_img(this)}),a(b).scroll(function(a){c._better_scroll_event_handler(d,a)}),a(b).resize(function(a){c._event_handler(d,a)}),this._event_handler(d)},c.prototype._better_scroll_event_handler=function(a){var c=this;0!==this.timer&&(this.increment++,b.clearTimeout(this.timer)),this.timer=b.setTimeout(function(){c._event_handler(a)},c.increment>5?50:0)},c.prototype._event_handler=function(c,d){var e=this,f=c.filter(function(){var c=a(this),d=a(b).scrollTop(),f=d+a(b).height(),g=c.offset().top,h=g+c.height(),i=e.options.threshold;return h>=d-i&&f+i>=g});c=d&&"scroll"==d.type&&_load_all_images_on_first_scroll?c.trigger("scrollin"):c.not(f.trigger("scrollin"))},c.prototype._load_img=function(b){var c=a(b),d=c.attr(this.options.attribute);c.unbind("scrollin").hide().removeAttr(this.options.attribute).attr("src",d).fadeIn().trigger("smartload")},a.fn[d]=function(b){return this.each(function(){a.data(this,"plugin_"+d)||a.data(this,"plugin_"+d,new c(this,b))})}}(jQuery,window,document);